## **JOB SYSTEM (FORMERLY 'TRAILFIELD') REWRITE**

### **1. Context & Rationale**
This project has undergone three (and a half) distinct evolutionary phases regarding unit navigation, each attempting to solve the balance between **Scale (500+ performant units)** and **Organic Feel ("Garden Fantasy")**.

* **Phase A: Scalar Pheromones (The Smell).**
* *Approach:* Units deposited intensity values (0.0â€“1.0) on a grid.
* *Result:* Good for general attraction, but lacked directional precision. Units would "swim" up gradients rather than commute efficiently.

* **Phase B: Discrete Rails (The Metro).**
* *Approach:* Global A* pathfinding generated static, spline-smoothed highways.
* *Result:* Highly efficient but visually rigid. Created "SimCity" artifacts (wiggly staircases) and struggled with dynamic obstacles. The "Global Brain" approach felt robotic.

* **Phase C: Flow Fields (The Trailfield + Job System Pivot).**
* *Trigger:* The realization that "Desire Paths" (Ant Colony Optimization) produce superior organic results than pre-calculated Splines.
* *The Shift:* We are moving from **Pathfinding** (calculating a route beforehand) to **Pathforming** (emerging a route through behavior).
* *Pivot:* This phase has been backburner'd in the course of development as a new solution (the 'job system') has been found. See section 5.

### **2. Codebase Flush and Rewrite**
A short-lived attempt at migrating to the flow fields ran into a series of subtle bugs, necessitating a deep purge of built up code cruft, followed by a rewrite from primitives.

The target remains a 'flow field' architecture. This document will be updated as the rewrite progresses.

### **3. Rebuilding from Primitives**
We cleaned the codebase and are now restoring tooling in tandem with entities, layer by layer. The near term target is being able to construct and manipulate a 'hardcoded level' live, even if all entities are inert.

Devtools were greatly expanded during this pass to smoothly manipulate levels, included a rudimentary serializer and loader.

### **4. Naive Steering and Robustness Tests**
We are restoring autonomous function gradually with the simplest behaviors like seeking, boids, collision avoidance, interaction buffer, etc. Short term target is iterating towards a metabolic loop (spawn -> find cookie -> haul to nest -> spawn...).

Sprig behavior should withstand user interruption and automatially reconfigure to adapt to a changing landscape.

### **5. "Gig Economy" Job System**
While rebuilding search and steering priority logic, we decided to future proof by laying the foundation for a more robust 'Job System' that matches idle Sprigs to tasks generated by the user or the environment. Ideally, this system results in a 'terrarrium' simulation which is semi-autonomous, supporting user-directed growth or 'organic' growth.

The unexpected robustness of this system has led to a pivot away from the original flowfield target so that development on pathfinding can end, and the project can return to its roadmap sooner. Fields are now a backup plan should we run into new scaling issues. 